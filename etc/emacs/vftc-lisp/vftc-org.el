(defun vftc-org-present--prepare-slide ()
  (org-overview)
  (org-show-entry)
  (org-show-children))

(defun vftc-org-present-hook ()
  (setq-local face-remapping-alist '((default (:height 1.5) variable-pitch)
                                     (header-line (:height 4.5) variable-pitch)
                                     (org-document-title (:height 1.75) org-document-title)
                                     (org-code (:height 1.55) org-code)
                                     (org-verbatim (:height 1.55) org-verbatim)
                                     (org-block (:height 1.25) org-block)
                                     (org-block-begin-line (:height 0.7) org-block)))
  (setq header-line-format " ")
  (org-appear-mode -1)
  (org-display-inline-images)
  (vftc-org-present--prepare-slide))

(defun vftc-org-present-quit-hook ()
  (setq-local face-remapping-alist '((default variable-pitch default)))
  (setq header-line-format nil)
  (org-present-small)
  (org-remove-inline-images)
  (org-appear-mode 1))

(defun vftc-org-present-prev ()
  (interactive)
  (org-present-prev)
  (vftc-org-present--prepare-slide))

(defun vftc-org-present-next ()
  (interactive)
  (org-present-next)
  (vftc-org-present--prepare-slide)
  (when (fboundp 'live-crafter-add-timestamp)
    (live-crafter-add-timestamp (substring-no-properties (org-get-heading t t t t)))))
